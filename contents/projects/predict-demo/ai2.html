<!DOCTYPE html>
<html>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs/dist/tf.min.js"> </script>
<script src="https://requirejs.org/docs/release/2.3.5/minified/require.js"> </script>

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="AI Odds Prediction demo" />
  <meta name="keywards" content="AI Odds Prediction demo" />
  <meta name="author" content="Kritdikoon Woraitthinan" />
  <title>AI Odds Prediction demo2</title>
  <link rel="stylesheet" href="/contents_resources/styles/mainStyles.css" />
  <link rel="icon" type="image/png" href="/images/J_favicon/favicon.ico" />

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-HDYFX99SK4"></script>

  <script>
    async function loadModel() {
      model = undefined;
      model = await tf.loadLayersModel("https://raw.githubusercontent.com/jingwora/jingwora.github.io/master/contents/projects/predict-demo/models2/model.json");
      console.log("model loaded")
    }
    loadModel();

    function make_prediction() {

      // reset
      document.getElementById("probWin").value = "-";
      document.getElementById("probLoss").value = "-";
      document.getElementById("probDraw").value = "-";
      document.getElementById("result").value = "-";
      document.getElementById("oddsWin").value = "-";
      document.getElementById("oddsLoss").value = "-";
      document.getElementById("oddsDraw").value = "-";

      // replace image
      var img = document.getElementById("runImage");

      img.src = "https://github.com/jingwora/jingwora.github.io/raw/master/contents/projects/predict-demo/img/ai_w_03_C.gif";

      // start timeout
      setTimeout(function () {
        img.src = "https://github.com/jingwora/jingwora.github.io/raw/master/contents/projects/predict-demo/img/ai_w_03.gif";

        // Calculation

        var v01, v02, v03, v04, v05, v06, v07;
        var output;

        v01 = Number(document.getElementById("v01").value);
        v02 = Number(document.getElementById("v02").value);
        v03 = Number(document.getElementById("v03").value);
        v04 = Number(document.getElementById("v04").value);
        v05 = Number(document.getElementById("v05").value);
        v06 = Number(document.getElementById("v06").value);
        v07 = Number(document.getElementById("v07").value);

        input_xs = tf.tensor2d([
          [v01, v02, v03, v04, v05, v06, v07]
        ]);

        // calculate WLD percentage

        output = model.predict(input_xs);
        const outputData = output.dataSync();
        var outputDataPercentage = [];

        for (var i = 0; i < outputData.length; i++) {
          var percentage = Number(outputData[i]).toLocaleString(undefined, { style: 'percent', minimumFractionDigits: 2 });;
          outputDataPercentage.push(percentage);
        }
        document.getElementById("probWin").value = outputDataPercentage[0];
        document.getElementById("probLoss").value = outputDataPercentage[1];
        document.getElementById("probDraw").value = outputDataPercentage[2];

        // calculate Results
        const maxIndex = outputData.indexOf(Math.max(...outputData));
        const outputmaxIndex = maxIndex;

        var resultShow;
        switch (maxIndex) {
          case 0:
            resultShow = "WIN";
            break;
          case 1:
            resultShow = "LOSE";
            break;
          case 2:
            resultShow = "DRAW";
            break;
        }
        document.getElementById("result").value = resultShow;

        // calculate Odds
        const vig = 0.15;
        var outputOdds = [];
        for (var i = 0; i < outputData.length; i++) {
          var odds = Number((1 - vig) / outputData[i]).toFixed(2);
          outputOdds.push(odds);
        }

        // convert odds in limit
        function convertLimit(num) {
          if (num > 99) {
            return 99.00;
          } else if (num < 1.01) {
            return 1.01;
          } else {
            return num;
          }
        }

        document.getElementById("oddsWin").value = convertLimit(outputOdds[0]);
        document.getElementById("oddsLoss").value = convertLimit(outputOdds[1]);
        document.getElementById("oddsDraw").value = convertLimit(outputOdds[2]);

        // End timeout
      }, 5000); // 5000 milliseconds = 5 seconds

    }
  </script>

  <style>
    body {
      background-color: #F9F9F9;
    }
  </style>

</head>

<body>
  <!-- NAVNIGATION BAR -->
  <p style="padding: 20px;"></p>

  <div class="navbar">
    <a class="main" href="https://jingwora.github.io">
      <img src="/images/J_favicon/favicon.ico" width="15" />
    </a>
    <a href="https://jingwora.github.io/projects.html">â—€ PROJECTS</a>
  </div>

  <!-- CONTENT -->

  <center> <br><br><br>
    <h1>Odds Prediction</h1><br>
  </center>

  <!-- Input -->
  <center>
    <h3>Input</h3>
  </center>

  <div class="prob-container" style="display:flex; justify-content:center;">
    <div class="prob-container" style="float:left;">
      Boxer1 &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp
    </div>
    <div class="prob-container" style="float:left;">
      Boxer2
    </div>
  </div>
  <br>

  <div class="prob-container" style="display:flex; justify-content:center;">
    <div class="prob-container" style="float:left;">
      lbs: <input id="v01" value="154.25" size="5"> &nbsp
    </div>
    <div class="prob-container" style="float:left;">
      lbs: <input id="v02" value="159.25" size="5">
    </div>
  </div>
  <br>

  <div class="prob-container" style="display:flex; justify-content:center;">
    <div class="prob-container" style="float:left;">
      win: <input id="v10" value="-" size="5"> &nbsp
    </div>
    <div class="prob-container" style="float:left;">
      win: <input id="v03" value="6" size="5">
    </div>
  </div>
  <br>

  <div class="prob-container" style="display:flex; justify-content:center;">
    <div class="prob-container" style="float:left;">
      lose: <input id="v10" value="-" size="5"> &nbsp
    </div>
    <div class="prob-container" style="float:left;">
      lose: <input id="v04" value="3" size="5">
    </div>
  </div>
  <br>

  <div class="prob-container" style="display:flex; justify-content:center;">
    <div class="prob-container" style="float:left;">
      draw: <input id="v10" value="-" size="5"> &nbsp
    </div>
    <div class="prob-container" style="float:left;">
      draw: <input id="v05" value="1" size="5">
    </div>
  </div>
  <br>

  <div class="prob-container" style="display:flex; justify-content:center;">
    <div class="prob-container" style="float:left;">
      KOs: <input id="v10" value="-" size="5"> &nbsp
    </div>
    <div class="prob-container" style="float:left;">
      KOs: <input id="v06" value="0.2041" size="5">
    </div>
  </div>
  <br>

  <div class="prob-container" style="display:flex; justify-content:center;">
    <div class="prob-container" style="float:left;">
      age: <input id="v10" value="-" size="5"> &nbsp
    </div>
    <div class="prob-container" style="float:left;">
      age: <input id="v07" value="44.0" size="5">
    </div>
  </div>
  <br>

  <!-- Button -->

  <center><button onclick="make_prediction()">Predict!</button></center>

  <!-- Image -->

  <center><img id="runImage"
      src="https://github.com/jingwora/jingwora.github.io/raw/master/contents/projects/predict-demo/img/ai_w_03.gif"
      height="300" width="300"></center>

  <!-- Output -->

  <center>
    <h3>Result</h3>
  </center>
  <br>

  <div class="prob-container" style="display:flex; justify-content:center;">
    <div class="prob-container" style="float:left;">
      W prob:<input id="probWin" size="5"> &nbsp
    </div>
    <div class="prob-container" style="float:left;">
      L prob:<input id="probLoss" size="5"> &nbsp
    </div>
    <div class="prob-container" style="float:left;">
      D prob:<input id="probDraw" size="5">
    </div>
  </div>

  <br>
  <center>Expected result:<input id="result" size="10"></center>
  <br>

  <div class="prob-container" style="display:flex; justify-content:center;">
    <div class="prob-container" style="float:left;">
      W Odds:<input id="oddsWin" size="5"> &nbsp
    </div>
    <div class="prob-container" style="float:left;">
      L Odds:<input id="oddsLoss" size="5"> &nbsp
    </div>
    <div class="prob-container" style="float:left;">
      D Odds:<input id="oddsDraw" size="5">
    </div>
  </div>
  <br>
  <center>Note: Max odds: 99, Min odds: 1.01</center>

  <br> <br>
</body>

<div style="padding-top: 3em;"></div>

<!-- Ending of Content -->
<hr />
<footer>
  &copy; Jingwora All rights reserved.
</footer>

</html>